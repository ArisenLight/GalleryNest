<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sign Up | GalleryNest</title>
  <link rel="stylesheet" href="css/styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />

<!-- Primary favicon (auto-detected by most browsers) -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

<!-- PWA / mobile icons -->
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
<link rel="manifest" href="/favicon/site.webmanifest">
<meta name="theme-color" content="#5A55EA">

<meta name="robots" content="noindex, nofollow">


</head>
<body>

    <!-- Branding Header -->
  <div class="auth-header">
    <a href="index.html" class="back-home">← Back to Home</a>
    <h1 class="auth-logo">GalleryNest</h1>
    <p class="powered-by">By <a href="https://syntaxcorestudio.com" target="_blank">SyntaxCore</a></p>
  </div>

  
  <div class="auth-container">
    <h2>Create Your Account</h2>
    <form id="signup-form">
      <input type="text" id="name" placeholder="Your Name" required />
      <input type="email" id="email" placeholder="Email" required />
      <input type="password" id="password" placeholder="Password" required />
      <button type="submit">Sign Up</button>
      <p class="auth-message" id="authMessage"></p>
    </form>
    <p class="switch-auth">
      Already have an account? <a href="login.html">Log in</a>
    </p>
  </div>

<footer style="text-align: center; padding: 20px; font-size: 0.85rem; color: #666;">
    <p>© 2025 SyntaxCore. All rights reserved. | <a href="terms.html">Terms</a> | <a href="privacy.html">Privacy</a></p>
  <p>GalleryNest is a product of SyntaxCore.</p>
</footer>


  <!-- Global Custom Modal -->
<div id="customAlertModal" class="modal">
  <div class="modal-content">
    <p id="customAlertMessage">Alert message goes here.</p>
    <button id="customAlertCloseBtn">Okay</button>
  </div>
</div>

  <script type="module" src="js/signup.js"></script>
  <script type="module" src="js/utils.js"></script>
  <script>
(function(){
  const params = new URLSearchParams(location.search);
  const plan = (params.get('plan') || 'free').toLowerCase();
  // Persist for post-auth flows
  localStorage.setItem('gn_selected_plan', plan);

  // Optional: reflect in the UI if you have radio buttons
  const el = document.querySelector(`input[name="plan"][value="${plan}"]`);
  if (el) el.checked = true;

  // Optional: text label
  const label = document.getElementById('selected-plan-label');
  if (label) label.textContent = plan.charAt(0).toUpperCase() + plan.slice(1);
})();
</script>
<script type="module">
import { initializeApp, getApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFunctions, httpsCallable } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-functions.js";

// If your other script already called initializeApp, you can skip this line and use getApp()
let app;
try { app = getApp(); } catch { 
  app = initializeApp({
    apiKey: "AIzaSyA1jTgM_13IjQS5V-Rc1-6cgC2YYV2GGxY",
    authDomain: "photogallery-saas.firebaseapp.com",
    projectId: "photogallery-saas",
    storageBucket: "photogallery-saas.firebasestorage.app",
    messagingSenderId: "1044919360261",
    appId: "1:1044919360261:web:0a81345d9ae1937856756c",
    measurementId: "G-GGZXM39LHV"
  });
}

const auth = getAuth(app);
// IMPORTANT: set region to australia-southeast1 for your Gen 2 callables
const functions = getFunctions(app, "australia-southeast1");

async function startCheckout() {
  const plan = (localStorage.getItem("gn_selected_plan") || "pro").toLowerCase();
  const createCheckout = httpsCallable(functions, "createCheckoutSessionV2");

  try {
    const { data } = await createCheckout({ plan });
    if (data?.url) {
      location.assign(data.url);
    } else if (data?.id) {
      // If you later add Stripe.js redirectToCheckout, use data.id
      alert("Checkout session created but no URL returned.");
    } else {
      throw new Error("No session returned from server");
    }
  } catch (err) {
    console.error("Checkout failed:", err);
    alert("Could not start checkout. Please try again.");
  }
}

// If you want a button on this page, add it to the HTML and wire it up:
document.getElementById("start-trial-btn")?.addEventListener("click", async () => {
  if (!auth.currentUser) {
    location.assign("/login.html?next=checkout");
    return;
  }
  await startCheckout();
});

// Also support auto-redirect after login
onAuthStateChanged(auth, (user) => {
  const params = new URLSearchParams(location.search);
  if (user && params.get("next") === "checkout") {
    startCheckout();
  }
});
</script>



</body>
</html>
